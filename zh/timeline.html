<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Growyå„¿ç«¥å‘å±•æ—¶é—´çº¿(Beta)</title>
    <style>
        :root {
            /* å“ç‰Œä¸»è§†è§‰ */
            --brand-deep-green: #1B5E20; 
            --brand-light-gray: #F5F7FA;
            
            --primary: var(--brand-deep-green);
            --bg: var(--brand-light-gray);
            --card-bg: #FFFFFF;

            /* ç´§è¿«æ€§é¢œè‰²å°º */
            --green-critical: #1B5E20; /* å…³é”®æœŸ (Critical) - æš—ç»¿ */
            --green-sensitive: #2E7D32; /* æ•æ„ŸæœŸ (Sensitive) - ä¸­ç»¿ */
            --green-open: #7CB342;     /* å‘å±•æœŸ (Open) - æµ…ç»¿ */
            
            --gray-bar: #f0f0f0;
            --text-main: #2C3E50;
            --text-sub: #607D8B;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            padding: 20px 15px;
            box-sizing: border-box;
            position: relative;
        }

        /* è¿”å›é¦–é¡µé“¾æ¥ */
        .back-link {
            position: absolute;
            top: 20px;
            left: 15px;
            font-size: 0.85rem;
            color: var(--text-sub);
            text-decoration: none;
            display: flex;
            align-items: center;
            font-weight: 500;
            z-index: 10;
        }
        .back-link:hover { color: var(--primary); }

        /* Header */
        .header { text-align: center; margin-bottom: 20px; position: relative; padding-top: 10px; }
        
        /* Language Switcher */
        .lang-switcher {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 0;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
            background: white;
        }
        .lang-btn {
            padding: 6px 12px;
            font-size: 0.75rem;
            font-weight: 600;
            border: none;
            background: white;
            color: var(--text-sub);
            cursor: pointer;
            transition: all 0.2s;
        }
        .lang-btn.active {
            background: var(--primary);
            color: white;
        }
        .lang-btn:hover:not(.active) {
            background: #f5f5f5;
        }
        
        .logo-image { 
            width: 40px; 
            height: 40px; 
            margin: 0 auto 10px; 
            object-fit: contain;
            display: block; 
        } 

        h1 { font-size: 1.4rem; margin: 0 0 5px 0; color: var(--primary); letter-spacing: -0.5px; }
        .tagline { 
            color: var(--text-sub); 
            font-size: 0.8rem; 
            line-height: 1.5;
        }
        .tagline-instruction {
            display: block;
            margin-top: 4px;
            font-size: 0.75rem;
        }

        /* Control Panel */
        .control-panel {
            background: #fff;
            border: 1px solid #eef2f5;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }

        .age-row { display: flex; align-items: baseline; justify-content: center; margin-bottom: 5px; }
        .age-display { font-size: 2.2rem; font-weight: 800; color: var(--primary); font-variant-numeric: tabular-nums; line-height: 1; margin-right: 5px; }
        .age-unit { font-size: 0.9rem; font-weight: 500; color: var(--text-sub); }

        /* Slider wrapper to match chart-row grid */
        .slider-wrapper {
            display: grid;
            grid-template-columns: 85px 1fr;
            gap: 10px;
            align-items: center;
            margin: 10px 0 15px 0;
        }

        .slider-label {
            font-size: 0.75rem;
            color: transparent;
            height: 0;
        }

        input[type=range] { width: calc(100% + 40px); margin: 0 -20px; -webkit-appearance: none; appearance: none; background: transparent; }
        input[type=range]:focus { outline: none; }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--green-critical);
            cursor: pointer;
            margin-top: -10px;
            box-shadow: 0 2px 5px rgba(27, 94, 32, 0.3);
            border: 3px solid white;
        }

        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #e0e0e0; border-radius: 2px; }

        /* Top Focus Bar */
        .top-focus-bar { min-height: 24px; display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; }
        .mini-badge { font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; color: white; display: flex; align-items: center; gap: 4px; font-weight: 500; }

        /* Chart Architecture */
        .layer-section { margin-bottom: 15px; }
        
        .layer-header { display: flex; align-items: center; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 1px solid #f0f0f0; }
        .layer-icon { font-size: 1rem; margin-right: 6px; }
        .layer-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; color: #999; font-weight: 700; }

        .chart-row {
            display: grid;
            grid-template-columns: 85px 1fr;
            gap: 10px;
            margin-bottom: 8px;
            align-items: center;
            min-height: 20px;
        }

        .skill-name {
            text-align: left;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-main);
            white-space: normal;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1;
            cursor: pointer; 
            transition: color 0.2s;
            max-height: 2em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            gap: 0.3em;
        }
        .skill-name:hover {
            color: var(--green-critical);
        }

        .bar-track { position: relative; height: 12px; background: var(--gray-bar); border-radius: 6px; width: 100%; overflow: hidden; }
        .active-bar { position: absolute; height: 100%; top: 0; border-radius: 6px; }

        /* Indicator Line - Fixed Alignment */
        .indicator-container { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            left: 95px; /* 85px label + 10px gap */ 
            right: 0; 
            pointer-events: none; 
            z-index: 10; 
        }
        .indicator-line { 
            position: absolute; 
            top: -5px; 
            bottom: -5px; 
            width: 2px; 
            background-color: var(--primary); 
            opacity: 0.6; 
            transition: left 0.1s linear; 
        }

        /* Info Panel */
        .info-panel { margin-top: 25px; background: #fff; border: 1px solid #eee; border-radius: 12px; overflow: hidden; }
        .info-header { background: #fcfcfc; padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: bold; font-size: 0.9rem; color: var(--primary); display: flex; justify-content: space-between; align-items: center; }
        .info-content { padding: 15px; }

        .advice-card { margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px dashed #f0f0f0; }
        .advice-card:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .advice-title-row { display: flex; align-items: center; margin-bottom: 4px; flex-wrap: wrap; gap: 6px;}
        .advice-name { font-weight: 700; font-size: 0.95rem; color: var(--text-main); }
        .urgency-badge { font-size: 0.6rem; color: white; padding: 2px 6px; border-radius: 4px; font-weight: normal;}
        .advice-desc { font-size: 0.85rem; color: #555; line-height: 1.5; margin-top: 4px;}

        /* Disclaimer */
        .disclaimer { margin-top: 15px; font-size: 0.65rem; color: #bbb; text-align: center; line-height: 1.4; padding-bottom: 10px; }

        /* Detail Card Style */
        .detail-card-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4); display: flex; justify-content: center; align-items: center;
            z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .detail-card-overlay.visible { opacity: 1; visibility: visible; }
        .detail-card {
            background: var(--card-bg); padding: 20px; margin: 20px; border-radius: 12px;
            width: 90%; max-width: 400px; max-height: 80vh; overflow-y: auto;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            transform: translateY(20px); transition: transform 0.3s;
        }
        .detail-card-overlay.visible .detail-card { transform: translateY(0); }
        .card-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-bottom: 15px; }
        .card-title { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
        .card-close { background: none; border: none; font-size: 1.5rem; color: var(--text-sub); cursor: pointer; line-height: 1; }
        .card-content p { font-size: 0.9rem; line-height: 1.6; margin: 0 0 10px 0; color: var(--text-main); }
        .stage-divider { 
            border-top: 2px solid #f0f0f0; 
            margin: 15px 0; 
            padding-top: 15px;
        }
        .stage-title {
            font-size: 0.85rem;
            color: var(--text-sub);
            font-weight: 600;
            margin-bottom: 8px;
        }
        .theory-section { font-weight: 600; color: var(--text-main); margin-bottom: 5px; }
        .advice-section { font-weight: normal; margin-top: 10px; color: #555; padding-left: 10px; border-left: 3px solid var(--green-sensitive); }
    </style>
</head>
<body>

<div class="container">
    <a href="index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>

    <div class="header">
        <div class="lang-switcher">
            <button class="lang-btn active" id="langZh" onclick="switchLanguage('zh')">ä¸­</button>
            <button class="lang-btn" id="langEn" onclick="switchLanguage('en')">En</button>
        </div>
        <img src="images/logo.png" alt="Growy Logo" class="logo-image" onerror="this.style.display='none'">
        <h1>Growyå„¿ç«¥å‘å±•æ—¶é—´çº¿ (Beta)</h1>
        <p class="tagline">
            åŸºäºè„‘ç§‘å­¦ä¸å‘å±•å¿ƒç†å­¦çš„ 0-18 å²èƒ½åŠ›åŸ¹å…»æ—¶é—´çº¿
            <span class="tagline-instruction">ğŸ‘‡ æ‹–åŠ¨ä¸‹æ–¹æ»‘åŠ¨æ¡æŸ¥çœ‹å­©å­å½“å‰å¹´é¾„æ®µå…³æ³¨é‡ç‚¹</span>
        </p>
    </div>

    <div class="control-panel">
        <div class="age-row">
            <div class="age-display" id="ageVal">0</div>
            <div class="age-unit">å²</div>
        </div>
        <div id="topFocusBar" class="top-focus-bar"></div>
        <div class="slider-wrapper">
            <div class="slider-label"></div>
            <input type="range" id="ageSlider" min="0" max="18" step="0.5" value="0">
        </div>
    </div>

    <div id="chartArea" style="position: relative;">
        <div class="indicator-container">
            <div id="indicator" class="indicator-line"></div>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <div class="info-header"><span>å½“å‰å¹´é¾„å»ºè®® (ä»…ä¾›å‚è€ƒ)</span></div>
        <div class="info-content" id="infoContent"></div>
    </div>

    <div class="disclaimer">
        <p>å…è´£å£°æ˜ï¼šæœ¬å·¥å…·ä»…ä¾›æ•™è‚²å‚è€ƒï¼Œä¸æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ã€‚</p>
        <p>Â© 2025 GrowyAI Â· ä¿ç•™æ‰€æœ‰æƒåˆ©</p>
    </div>
</div>

<!-- Detail Card Modal -->
<div class="detail-card-overlay" id="detailCardOverlay">
    <div class="detail-card">
        <div class="card-header">
            <div class="card-title" id="cardTitle"></div>
            <button class="card-close" onclick="hideDetailCard()">Ã—</button>
        </div>
        <div class="card-content" id="cardContent"></div>
    </div>
</div>

<script>
    // Language Switcher
    function switchLanguage(lang) {
        if (lang === 'zh') {
            // Already here
        } else if (lang === 'en') {
            window.location.href = '../en/timeline.html';
        }
    }

    // Data - Merged Skills with Multiple Stages
    const layers = [
        {
            id: "L1", title: "Layer 1: åº•å±‚åŸºçŸ³", icon: "ğŸŒ±",
            skills: [
                { 
                    name: "èº«ä½“å¥åº·", 
                    segments: [
                        { start: 0, end: 1, urgency: 3, desc: "**ã€å©´å„¿æœŸ 0-1å²ï¼šå…³é”®æœŸã€‘** å»ºç«‹åŸºç¡€å¥åº·ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸ¼ ç¡çœ 12-16å°æ—¶ã€‚å»ºç«‹å›ºå®šä»ªå¼ï¼ŒåšæŒä»°å§ã€‚\n0-6æœˆçº¯æ¯ä¹³/é…æ–¹å¥¶ï¼›6æœˆåé€æ­¥æ·»åŠ è¾…é£Ÿï¼ˆé¦–é€‰è¡¥é“ç±³ç²‰ï¼‰ã€‚\næ¯æ—¥å¤šæ¬¡Tummy Timeï¼ˆä¿¯å§ï¼‰ï¼Œé¼“åŠ±ç¿»èº«çˆ¬è¡Œã€‚*" },
                        { start: 1, end: 2, urgency: 3, desc: "**ã€å¹¼å„¿æœŸ 1-2å²ï¼šå…³é”®æœŸã€‘** é€‚åº”å¤šæ ·åŒ–è¥å…»ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸ‘§ ç¡çœ 11-14å°æ—¶ã€‚é¢„é˜²åˆ†ç¦»ç„¦è™‘å¯¼è‡´çš„å€’é€€ã€‚\nå°è¯•å¤šæ ·åŒ–å®¶åº­é£Ÿç‰©ï¼›æ¯æ—¥350-500mlå…¨è„‚å¥¶ã€‚\næ¯æ—¥ç´¯è®¡3å°æ—¶æ´»åŠ¨ï¼Œç»ƒä¹ è·‘ã€æ‰”ã€çˆ¬ã€‚*" },
                        { start: 2, end: 3, urgency: 3, desc: "**ã€æ‰˜å¹¼æœŸ 2-3å²ï¼šå…³é”®æœŸã€‘** å»ºç«‹è¿›é£Ÿå’Œæ´»åŠ¨ä¹ æƒ¯ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸˆ ç¡çœ 11-14å°æ—¶ã€‚ä¿æŒé»‘æš—å‡‰çˆ½ç¯å¢ƒã€‚\né¢„é˜²æŒ‘é£Ÿï¼Œé™åˆ¶å«ç³–å’ŒåŠ å·¥é£Ÿå“ï¼Œå­¦ä¹ ç”¨é¤å…·ã€‚\nç»ƒä¹ å¹³è¡¡ä¸åè°ƒï¼ˆå•è„šè·³ã€éª‘è½¦ï¼‰ï¼›å±å¹•æ—¶é—´<1å°æ—¶ã€‚*" },
                        { start: 3, end: 6, urgency: 2, desc: "**ã€å­¦é¾„å‰ 3-6å²ï¼šæ•æ„ŸæœŸã€‘** é”»ç‚¼ä¸è§„å¾‹ä½œæ¯ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸ« ç¡çœ 10-13å°æ—¶ã€‚å»ºç«‹è§„å¾‹ä½œæ¯ä»¥å¯¹æ¥å¹¼å„¿å›­ã€‚\nä¿è¯ä¼˜è´¨è›‹ç™½å’Œå…¨è°·ç‰©ï¼Œå…»æˆé¤æ¡Œç¤¼ä»ªã€‚\næ¯æ—¥60åˆ†é’Ÿä¸­é«˜å¼ºåº¦è¿åŠ¨ï¼Œé”»ç‚¼çµæ´»æ€§ã€‚å±å¹•æ—¶é—´<1å°æ—¶ï¼Œé¥®æ°´ä»¥ç™½å¼€æ°´ä¸ºä¸»ç¦ç³–ã€‚*" },
                        { start: 6, end: 12, urgency: 1, desc: "**ã€å­¦é¾„æœŸ 6-12å²ï¼šç»´æŒæœŸã€‘** å·©å›ºè¿åŠ¨ä¸è¥å…»ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸ“š ç¡çœ 9-12å°æ—¶ã€‚ç¡å‰1å°æ—¶ç¦ç”¨ç”µå­äº§å“ã€‚\nå¿…é¡»åƒæ—©é¤ï¼Œè¡¥å……é’™ä¸ç»´ç”Ÿç´ Dã€‚\nå‚ä¸ä½“è‚²æ´»åŠ¨ï¼›æ¯å‘¨3æ¬¡ä»¥ä¸ŠåŠ›é‡è®­ç»ƒï¼ˆå¦‚æ”€çˆ¬ï¼‰ã€‚*" },
                        { start: 12, end: 18, urgency: 1, desc: "**ã€é’æ˜¥æœŸ 12-18å²ï¼šç»´æŒæœŸã€‘** åº”å¯¹ç”Ÿç†å˜åŒ–ã€‚*åŸ¹å…»å»ºè®®ï¼šğŸ‘¨ ç¡çœ 8-10å°æ—¶ã€‚è­¦æƒ•æ™šç¡å¼•èµ·çš„ç¡çœ ä¸è¶³ã€‚\nèƒ½é‡éœ€æ±‚æ¿€å¢ï¼Œé‡ç‚¹è¡¥é“è¡¥é’™ï¼Œé¿å…èŠ‚é£Ÿã€‚\næ¯æ—¥60åˆ†é’Ÿæœ‰æ°§+æŠ—é˜»è®­ç»ƒï¼Œé€šè¿‡è¿åŠ¨è§£å‹ã€‚\nâš ï¸ ä¸¥é‡å‘è‚²è¿Ÿç¼“æˆ–ç¡çœ éšœç¢è¯·å°±åŒ»ã€‚*" }
                    ]
                },
                { 
                    name: "å®‰å…¨ä¾æ‹", 
                    segments: [
                        { start: 0, end: 1.5, urgency: 3, desc: "**ã€Bowlby å…³é”®æœŸã€‘** å©´å„¿é€šè¿‡ä¸»è¦å…»è‚²è€…**åŠæ—¶ä¸”ä¸€è‡´**çš„å›åº”ï¼Œæ„å»ºã€Œå†…éƒ¨å·¥ä½œæ¨¡å‹ã€çš„åŸºçŸ³ã€‚*åŸ¹å…»å»ºè®®ï¼šå»ºç«‹å›ºå®šçš„å®‰æŠšæ¨¡å¼ï¼ˆSecure Baseï¼‰ï¼Œå¹¶å›åº”å“­æ³£è€Œéæƒ©ç½šï¼Œä»¥å»ºç«‹åŸºæœ¬ä¿¡ä»»ã€‚*" },
                        { start: 1.5, end: 3, urgency: 2, desc: "**ã€Erikson ä¿¡ä»» vs. è‡ªä¸»ã€‘** åœ¨å®‰å…¨ä¾æ‹åŸºç¡€ä¸Šï¼Œå­©å­å¼€å§‹æ¢ç´¢ä¸–ç•Œå¹¶å¯»æ±‚ç‹¬ç«‹ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±å­©å­åœ¨ã€Œå®‰å…¨åŸºåœ°ã€é™„è¿‘è‡ªä¸»æ¢ç´¢ï¼Œæä¾›é€‰æ‹©æƒï¼Œæ”¯æŒå¹¶æ¥çº³åˆ†ç¦»æƒ…ç»ªã€‚*" }
                    ]
                },
                { 
                    name: "è‡ªæˆ‘æ„è¯†", 
                    segments: [
                        { start: 1.5, end: 3, urgency: 2, desc: "**ã€é•œå­å®éªŒã€‘** å­©å­å¼€å§‹åŒºåˆ†è‡ªæˆ‘ä¸ä»–äººï¼Œå‡ºç°ã€Œæˆ‘ã€çš„æ¦‚å¿µã€‚*åŸ¹å…»å»ºè®®ï¼šåœ¨æ—¥å¸¸å¯¹è¯ä¸­å¤šä½¿ç”¨ã€Œä½ åšåˆ°äº†ã€æˆ–ã€Œä½ æ„Ÿè§‰å¦‚ä½•ã€ï¼Œå¸®åŠ©å­©å­å»ºç«‹ç§¯æçš„è‡ªæˆ‘æè¿°ã€‚*" },
                        { start: 12, end: 18, urgency: 2, desc: "**ã€Erikson èº«ä»½ vs. è¿·å¤±ã€‘** é’å°‘å¹´é€šè¿‡æ¢ç´¢ä»·å€¼è§‚å’Œè§’è‰²æ¥å›ç­”ã€Œæˆ‘æ˜¯è°ã€ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±å­©å­å‚ä¸å„ç§æ´»åŠ¨ï¼Œè¿›è¡Œå¼€æ”¾å¼è®¨è®ºï¼Œæ¥çº³ä»–ä»¬åˆç†çš„è´¨ç–‘ä¸æ¢ç´¢ã€‚*" }
                    ]
                }
            ]
        },
        {
            id: "L2", title: "Layer 2: æ·±å±‚èƒ½åŠ›", icon: "ğŸ§ ",
            skills: [
                { 
                    name: "å†…åœ¨åŠ¨æœº", 
                    segments: [
                        { start: 0, end: 7, urgency: 3, desc: "**ã€Deci è‡ªå†³ç†è®ºã€‘** ä¿æŠ¤å­©å­ä¸ç”Ÿä¿±æ¥çš„å¥½å¥‡å¿ƒã€‚*åŸ¹å…»å»ºè®®ï¼šå°‘ç”¨é‡‘é’±æˆ–ç‰©è´¨å¥–åŠ±ï¼Œå¤šèµç¾ã€Œè¿‡ç¨‹ã€è€Œéã€Œç»“æœã€ï¼Œå¼ºè°ƒè‡ªä¸»æ€§ã€‚*" }
                    ]
                },
                { 
                    name: "æŠ‘åˆ¶æ§åˆ¶", 
                    segments: [
                        { start: 3, end: 6, urgency: 3, desc: "**ã€æ‰§è¡ŒåŠŸèƒ½æ ¸å¿ƒã€‘** ä¸“æ³¨åŠ›ä¸è‡ªå¾‹çš„åŸºç¡€ã€‚*åŸ¹å…»å»ºè®®ï¼šç©ã€Œçº¢ç¯åœã€ç»¿ç¯è¡Œã€ç­‰è§„åˆ™æ¸¸æˆï¼›ä½¿ç”¨å»¶æ—¶æ»¡è¶³ç­–ç•¥ã€‚*" }
                    ]
                },
                { 
                    name: "æƒ…ç»ªè°ƒèŠ‚", 
                    segments: [
                        { start: 3, end: 7, urgency: 2, desc: "**ã€ç¥ç»å¯å¡‘æ€§ã€‘** å»ºç«‹åº”å¯¹è´Ÿé¢æƒ…ç»ªçš„ç¥ç»å›è·¯ã€‚*åŸ¹å…»å»ºè®®ï¼šæƒ…ç»ªå´©æºƒæ—¶å…ˆæ¥çº³ï¼Œå†å¼•å¯¼ç”¨è¯­è¨€è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ç«‹å³åˆ¶æ­¢ã€‚*" }
                    ]
                },
                { 
                    name: "è§‚ç‚¹é‡‡æ‹©", 
                    segments: [
                        { start: 4, end: 7, urgency: 2, desc: "**ã€å¿ƒæ™ºç†è®ºã€‘** ç†è§£ä»–äººçš„æ„å›¾ã€‚*åŸ¹å…»å»ºè®®ï¼šé€šè¿‡è®²æ•…äº‹ã€æé—®ï¼ˆã€Œä»–ä¸ºä»€ä¹ˆå“­ï¼Ÿã€ï¼‰å¼•å¯¼å­©å­æ¢ä½æ€è€ƒã€‚*" }
                    ]
                }
            ]
        },
        {
            id: "L3", title: "Layer 3: æ˜¾æ€§è¡¨ç°", icon: "âš¡",
            skills: [
                { 
                    name: "è¯­è¨€(è¯­éŸ³)", 
                    segments: [
                        { start: 0, end: 7, urgency: 3, desc: "**ã€å¤§è„‘ä¿®å‰ªæœŸã€‘** å¬è§‰å¯¹éŸ³ç´ æ•æ„Ÿåº¦ä¸‹é™ã€‚*åŸ¹å…»å»ºè®®ï¼šæä¾›ä¸°å¯Œè¾“å…¥ï¼Œå£éŸ³è¶Šçº¯æ­£è¶Šå¥½ï¼›äº²å­å¯¹è¯æ¯”å¬éŸ³é¢‘æ›´é‡è¦ã€‚*" }
                    ]
                },
                { 
                    name: "é€»è¾‘", 
                    segments: [
                        { start: 7, end: 11, urgency: 2, desc: "**ã€Piaget å…·ä½“è¿ç®—ã€‘** ç†è§£å®ˆæ’ã€åˆ†ç±»ã€‚*åŸ¹å…»å»ºè®®ï¼šé€šè¿‡åŠ¨æ‰‹æ“ä½œå®éªŒã€æ”¶é›†ä¸åˆ†ç±»ï¼Œç†è§£äº‹ç‰©å±æ€§ã€‚*" },
                        { start: 12, end: 18, urgency: 1, desc: "**ã€Piaget å½¢å¼è¿ç®—ã€‘** å‡è®¾-æ¼”ç»æ¨ç†ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±è¾©è®ºã€æ€è€ƒéç°å®å’Œå½¢è€Œä¸Šçš„é—®é¢˜ã€‚*" }
                    ]
                },
                { 
                    name: "è´¢å•†åŸºç¡€", 
                    segments: [
                        { start: 7, end: 18, urgency: 1, desc: "**ã€ç»æµå¿ƒç†å­¦ã€‘** ç†è§£å»¶è¿Ÿæ»¡è¶³å’Œæœºä¼šæˆæœ¬ã€‚*åŸ¹å…»å»ºè®®ï¼šåˆ©ç”¨é›¶èŠ±é’±å’Œé€æ˜ç½å­è¿›è¡Œã€Œæƒ³è¦ã€å’Œã€Œéœ€è¦ã€çš„åˆ†ç±»å®è·µã€‚*" }
                    ]
                },
                { 
                    name: "ç»˜ç”»", 
                    segments: [
                        { start: 3, end: 7, urgency: 2, desc: "**ã€å›¾å¼æœŸã€‘** ä¿æŠ¤è¡¨è¾¾æ¬²ã€‚*åŸ¹å…»å»ºè®®ï¼šä¸è¯„ä»·ã€Œåƒä¸åƒã€ï¼Œåªæé—®ï¼šã€Œä½ ç”»çš„æ˜¯ä»€ä¹ˆï¼Ÿã€*" },
                        { start: 9, end: 12, urgency: 2, desc: "**ã€å†™å®æ•æ„ŸæœŸã€‘** å¼•å…¥è§‚å¯Ÿæ³•ä¸æŠ€å·§ã€‚*åŸ¹å…»å»ºè®®ï¼šæ•™å¯¼åŸºç¡€å‡ ä½•ç»“æ„å’Œæ¯”ä¾‹ï¼Œå¸®åŠ©å¼¥åˆè§†è§‰ä¸è¡¨è¾¾çš„å·®è·ã€‚*" }
                    ]
                },
                { 
                    name: "éŸ³ä¹", 
                    segments: [
                        { start: 3, end: 6, urgency: 3, desc: "**ã€æçŸ­çª—å£ã€‘** å¬è§‰ç¥ç»è¿æ¥å›ºå®šå‰ï¼Œç»å¯¹éŸ³æ„ŸåŸ¹å…»çš„å…³é”®æœŸã€‚*åŸ¹å…»å»ºè®®ï¼šè¿›è¡Œç³»ç»Ÿæ€§éŸ³é«˜å¬è¾¨è®­ç»ƒï¼Œé”™è¿‡éš¾åº¦æŒ‡æ•°çº§ä¸Šå‡ã€‚*" },
                        { start: 6, end: 10, urgency: 2, desc: "**ã€ç²¾ç»†åŠ¨ä½œé«˜å³°ã€‘** å»ºç«‹è‚Œè‚‰è®°å¿†ã€‚*åŸ¹å…»å»ºè®®ï¼šé€‰æ‹©é€‚åˆæ‰‹éƒ¨å‘è‚²çš„ä¹å™¨ï¼Œè§„å¾‹çŸ­æ—¶ç»ƒä¹ ã€‚*" }
                    ]
                },
                { 
                    name: "è¿åŠ¨", 
                    segments: [
                        { start: 5, end: 10, urgency: 2, desc: "**ã€éŸ§å¸¦å¯å¡‘æ€§ã€‘** éª¨éª¼ç”Ÿé•¿å‰ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±ä½“æ“ã€èˆè¹ˆæˆ–æ­¦æœ¯ç­‰å¤§èŒƒå›´è¿åŠ¨ã€‚*" },
                        { start: 14, end: 18, urgency: 2, desc: "**ã€ç”Ÿç†é€‚åº”é«˜å³°ã€‘** éª¨éª¼æˆç†Ÿä¸æ¿€ç´ æ°´å¹³ä¸Šå‡ã€‚*åŸ¹å…»å»ºè®®ï¼šä»åŸºç¡€ä½“èƒ½è½¬å‘é«˜è´Ÿè·åŠ›é‡è®­ç»ƒï¼Œéœ€ä¸“ä¸šæŒ‡å¯¼ã€‚*" }
                    ]
                }
            ]
        }
    ];

    // DOM Elements
    const chartArea = document.getElementById('chartArea');
    const indicator = document.getElementById('indicator');
    const slider = document.getElementById('ageSlider');
    const ageVal = document.getElementById('ageVal');
    const infoContent = document.getElementById('infoContent');
    const topFocusBar = document.getElementById('topFocusBar');
    const detailCardOverlay = document.getElementById('detailCardOverlay');
    const cardTitle = document.getElementById('cardTitle');
    const cardContent = document.getElementById('cardContent');
    const colors = { 3: 'var(--green-critical)', 2: 'var(--green-sensitive)', 1: 'var(--green-open)' };

    function renderChart() {
        chartArea.querySelectorAll('.layer-section').forEach(e => e.remove());
        layers.forEach(layer => {
            const section = document.createElement('div');
            section.className = 'layer-section';
            section.innerHTML = `<div class="layer-header"><span class="layer-icon">${layer.icon}</span><span class="layer-title">${layer.title}</span></div>`;
            layer.skills.forEach(skill => {
                const row = document.createElement('div');
                row.className = 'chart-row';
                const label = document.createElement('div');
                label.className = 'skill-name';
                label.innerText = skill.name;
                label.addEventListener('click', () => showDetailCard(skill));
                const track = document.createElement('div');
                track.className = 'bar-track';
                
                // Render all segments
                skill.segments.forEach(segment => {
                    const startPct = (segment.start / 18) * 100;
                    const endPct = (Math.min(segment.end, 18) / 18) * 100;
                    const widthPct = Math.max(endPct - startPct, 0);
                    if (widthPct > 0) {
                        const bar = document.createElement('div');
                        bar.className = 'active-bar';
                        bar.style.left = `${startPct}%`;
                        bar.style.width = `${widthPct}%`;
                        bar.style.backgroundColor = colors[segment.urgency];
                        track.appendChild(bar);
                    }
                });
                
                row.appendChild(label);
                row.appendChild(track);
                section.appendChild(row);
            });
            chartArea.appendChild(section);
        });
    }

    function getUrgencyText(urgency) { 
        return urgency === 3 ? "å…³é”®" : urgency === 2 ? "é‡è¦" : "ä¸€èˆ¬"; 
    }

    function showDetailCard(skill) {
        cardTitle.innerText = skill.name;
        let contentHtml = '';
        
        skill.segments.forEach((segment, index) => {
            if (index > 0) {
                contentHtml += '<div class="stage-divider"></div>';
            }
            contentHtml += `<div class="stage-title">${segment.start}-${segment.end}å²</div>`;
            
            const parts = segment.desc.split('*åŸ¹å…»å»ºè®®ï¼š');
            const theoryText = parts[0].trim().replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            let adviceText = parts.length > 1 ? parts[1].trim().replace(/\*/g, '') : '';
            contentHtml += `<div class="theory-section">ç†è®ºåŸºç¡€: ${theoryText}</div>`;
            if (adviceText) {
                contentHtml += `<div class="advice-section"><strong>åŸ¹å…»å»ºè®®:</strong> ${adviceText}</div>`;
            }
        });
        
        cardContent.innerHTML = contentHtml;
        detailCardOverlay.classList.add('visible');
    }
    
    function hideDetailCard() { 
        detailCardOverlay.classList.remove('visible'); 
    }
    
    detailCardOverlay.addEventListener('click', (e) => { 
        if (e.target === detailCardOverlay) hideDetailCard(); 
    });

    function updateUI() {
        const age = parseFloat(slider.value);
        ageVal.innerText = age;
        const pct = (age / 18) * 100;
        indicator.style.left = `${pct}%`;

        let activeItems = [];
        layers.forEach(layer => {
            layer.skills.forEach(skill => {
                skill.segments.forEach(segment => {
                    let isActive = (age >= segment.start && age < segment.end);
                    if (segment.end === 18 && age === 18) isActive = true;
                    if (isActive) {
                        activeItems.push({
                            name: skill.name,
                            urgency: segment.urgency,
                            desc: segment.desc,
                            allSegments: skill.segments
                        });
                    }
                });
            });
        });
        
        // Remove duplicates (same skill name)
        const uniqueItems = [];
        const seenNames = new Set();
        activeItems.forEach(item => {
            if (!seenNames.has(item.name)) {
                seenNames.add(item.name);
                uniqueItems.push(item);
            }
        });
        
        uniqueItems.sort((a, b) => b.urgency - a.urgency);

        // Top badges - no parentheses
        const topBadges = uniqueItems.slice(0, 3);
        topFocusBar.innerHTML = topBadges.length === 0 
            ? `<span style="color:#aaa; font-size:0.75rem;">å½“å‰æ— ç‰¹å®šå…³é”®çª—å£ (å¹³ç¨³æœŸ)</span>` 
            : topBadges.map(item => `<div class="mini-badge" style="background:${colors[item.urgency]}">${item.name}</div>`).join('');

        // Bottom info panel
        if (uniqueItems.length === 0) {
            infoContent.innerHTML = `<div style="text-align:center;color:#999;padding:10px;">å»ºè®®å·©å›ºåŸºç¡€ï¼Œä¿æŒè€å¿ƒã€‚</div>`;
        } else {
            infoContent.innerHTML = uniqueItems.map(item => {
                let cleanDesc = item.desc.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                const adviceMatch = cleanDesc.match(/\*åŸ¹å…»å»ºè®®ï¼š(.*?)\*/);
                let adviceHtml = adviceMatch ? `<br><span style="color:#444;">å»ºè®®: ${adviceMatch[1].trim()}</span>` : '';
                cleanDesc = cleanDesc.replace(/\*åŸ¹å…»å»ºè®®ï¼š.*?\*/, '');
                return `<div class="advice-card"><div class="advice-title-row"><span class="advice-name">${item.name}</span><span class="urgency-badge" style="background-color:${colors[item.urgency]}">${getUrgencyText(item.urgency)}</span></div><div class="advice-desc">${cleanDesc}${adviceHtml}</div></div>`;
            }).join('');
        }
    }

    renderChart();
    updateUI();
    slider.addEventListener('input', updateUI);
    window.addEventListener('resize', updateUI);
</script>
</body>
</html>