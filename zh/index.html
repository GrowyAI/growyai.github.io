<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Growyå„¿ç«¥å‘å±•æ—¶é—´çº¿(Beta)</title>
    <style>
        :root {
            /* å“ç‰Œä¸»è§†è§‰ */
            --brand-deep-green: #1B5E20; 
            --brand-light-gray: #F5F7FA;
            
            --primary: var(--brand-deep-green);
            --bg: var(--brand-light-gray);
            --card-bg: #FFFFFF;

            /* ç´§è¿«æ€§é¢œè‰²å°º */
            --green-critical: #1B5E20; /* å…³é”®æœŸ (Critical) - æš—ç»¿ */
            --green-sensitive: #43A047; /* æ•æ„ŸæœŸ (Sensitive) - ä¸­ç»¿ */
            --green-open: #A5D6A7;     /* å‘å±•æœŸ (Open) - æµ…ç»¿ */
            
            --gray-bar: #f0f0f0;
            --text-main: #2C3E50;
            --text-sub: #607D8B;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
            padding: 20px 15px;
            box-sizing: border-box;
        }

        /* Header */
        .header { text-align: center; margin-bottom: 20px; position: relative; }
        
        /* Language Switcher */
        .lang-switcher {
            position: absolute;
            top: 0;
            right: 0;
            display: flex;
            gap: 0;
            border: 1px solid #ddd;
            border-radius: 6px;
            overflow: hidden;
            background: white;
        }
        .lang-btn {
            padding: 6px 12px;
            font-size: 0.75rem;
            font-weight: 600;
            border: none;
            background: white;
            color: var(--text-sub);
            cursor: pointer;
            transition: all 0.2s;
        }
        .lang-btn.active {
            background: var(--primary);
            color: white;
        }
        .lang-btn:hover:not(.active) {
            background: #f5f5f5;
        }
        
        /* ä¿®å¤ Logo æ˜¾ç¤ºæ ·å¼ */
        .logo-image { 
            width: 40px; 
            height: 40px; 
            margin: 0 auto 10px; /* å±…ä¸­å¹¶åœ¨ä¸‹æ–¹ç•™å‡ºç©ºé—´ */
            object-fit: contain;
            display: block; /* ç¡®ä¿ Logo å¯è§ */
        } 

        h1 { font-size: 1.4rem; margin: 0 0 5px 0; color: var(--primary); letter-spacing: -0.5px; }
        .tagline { color: var(--text-sub); font-size: 0.8rem; line-height: 1.4; }

        /* Control Panel */
        .control-panel {
            background: #fff;
            border: 1px solid #eef2f5;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.02);
        }

        .age-row { display: flex; align-items: baseline; justify-content: center; margin-bottom: 5px; }
        .age-display { font-size: 2.2rem; font-weight: 800; color: var(--primary); font-variant-numeric: tabular-nums; line-height: 1; margin-right: 5px; }
        .age-unit { font-size: 0.9rem; font-weight: 500; color: var(--text-sub); }

        input[type=range] { width: 100%; margin: 10px 0 15px 0; -webkit-appearance: none; appearance: none; background: transparent; }
        input[type=range]:focus { outline: none; }
        
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--green-critical);
            cursor: pointer;
            margin-top: -10px;
            box-shadow: 0 2px 5px rgba(27, 94, 32, 0.3);
            border: 3px solid white;
        }

        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 4px; background: #e0e0e0; border-radius: 2px; }

        /* Top Focus Bar */
        .top-focus-bar { min-height: 24px; display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; }
        .mini-badge { font-size: 0.75rem; padding: 2px 8px; border-radius: 4px; color: white; display: flex; align-items: center; gap: 4px; font-weight: 500; animation: fadeIn 0.3s ease; }

        /* Chart Architecture */
        .layer-section { margin-bottom: 15px; }
        
        .layer-header { display: flex; align-items: center; margin-bottom: 8px; padding-bottom: 4px; border-bottom: 1px solid #f0f0f0; }
        .layer-icon { font-size: 1rem; margin-right: 6px; }
        .layer-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.5px; color: #999; font-weight: 700; }

        .chart-row {
            display: grid;
            grid-template-columns: 85px 1fr;
            gap: 10px;
            margin-bottom: 8px;
            align-items: center;
            min-height: 20px;
        }

        .skill-name {
            text-align: left;
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--text-main);
            white-space: normal;
            overflow: hidden;
            text-overflow: ellipsis;
            line-height: 1;
            cursor: pointer; 
            transition: color 0.2s;
            max-height: 2em;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            gap: 0.3em;
        }
        .skill-name:hover {
            color: var(--green-critical);
        }

        .bar-track { position: relative; height: 12px; background: var(--gray-bar); border-radius: 6px; width: 100%; overflow: hidden; }
        .active-bar { position: absolute; height: 100%; top: 0; border-radius: 6px; }

        /* Indicator Line - Fixed Alignment */
        .indicator-container { 
            position: absolute; 
            top: 0; 
            bottom: 0; 
            left: 95px; /* 85px label + 10px gap */ 
            right: 0; 
            pointer-events: none; 
            z-index: 10; 
        }
        .indicator-line { 
            position: absolute; 
            top: -5px; 
            bottom: -5px; 
            width: 2px; 
            background-color: var(--primary); 
            opacity: 0.6; 
            transition: left 0.1s linear; 
        }

        /* Info Panel */
        .info-panel { margin-top: 25px; background: #fff; border: 1px solid #eee; border-radius: 12px; overflow: hidden; }
        .info-header { background: #fcfcfc; padding: 10px 15px; border-bottom: 1px solid #eee; font-weight: bold; font-size: 0.9rem; color: var(--primary); display: flex; justify-content: space-between; align-items: center; }
        .info-content { padding: 15px; }

        .advice-card { margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px dashed #f0f0f0; }
        .advice-card:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .advice-title-row { display: flex; align-items: center; margin-bottom: 4px; flex-wrap: wrap; gap: 6px;}
        .advice-name { font-weight: 700; font-size: 0.95rem; color: var(--text-main); }
        .urgency-badge { font-size: 0.6rem; color: white; padding: 2px 6px; border-radius: 4px; font-weight: normal;}
        .advice-desc { font-size: 0.85rem; color: #555; line-height: 1.5; margin-top: 4px;}

        /* Footer Links */
        .footer-links {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .footer-link-item {
            font-size: 0.8rem;
            color: var(--text-sub);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: color 0.2s;
        }
        .footer-link-item:hover { color: var(--primary); }
        
        /* Disclaimer */
        .disclaimer { margin-top: 15px; font-size: 0.65rem; color: #bbb; text-align: center; line-height: 1.4; padding-bottom: 10px; }

        /* Detail Card Style */
        .detail-card-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4); display: flex; justify-content: center; align-items: center;
            z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s;
        }
        .detail-card-overlay.visible { opacity: 1; visibility: visible; }
        .detail-card {
            background: var(--card-bg); padding: 20px; margin: 20px; border-radius: 12px;
            width: 90%; max-width: 400px; box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            transform: translateY(20px); transition: transform 0.3s;
        }
        .detail-card-overlay.visible .detail-card { transform: translateY(0); }
        .card-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-bottom: 15px; }
        .card-title { font-size: 1.2rem; font-weight: 700; color: var(--primary); }
        .card-close { background: none; border: none; font-size: 1.5rem; color: var(--text-sub); cursor: pointer; line-height: 1; }
        .card-content p { font-size: 0.9rem; line-height: 1.6; margin: 0 0 10px 0; color: var(--text-main); }
        .theory-section { font-weight: 600; color: var(--text-main); margin-bottom: 5px; }
        .advice-section { font-weight: normal; margin-top: 10px; color: #555; padding-left: 10px; border-left: 3px solid var(--green-sensitive); }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
        <div class="lang-switcher">
            <button class="lang-btn active" id="langZh" onclick="switchLanguage('zh')">ä¸­æ–‡</button>
            <button class="lang-btn" id="langEn" onclick="switchLanguage('en')">English</button>
        </div>
        <!-- é‡æ–°æ·»åŠ  Logo æ ‡ç­¾ -->
        <img src="images/logo.png" alt="Growy Logo" class="logo-image" onerror="this.style.display='none'">
        <h1>Growyå„¿ç«¥å‘å±•æ—¶é—´çº¿ (Beta)</h1>
        <p class="tagline">åŸºäºè„‘ç§‘å­¦ä¸å‘å±•å¿ƒç†å­¦çš„ 0-18 å²èƒ½åŠ›åŸ¹å…»æ—¶é—´çº¿ï¼Œæ‹–åŠ¨ä¸‹æ–¹æ»‘åŠ¨æ¡æŸ¥çœ‹å­©å­å½“å‰å¹´é¾„æ®µå…³æ³¨é‡ç‚¹</p>
    </div>

    <div class="control-panel">
        <div class="age-row">
            <div class="age-display" id="ageVal">0</div>
            <div class="age-unit">å²</div>
        </div>
        <div id="topFocusBar" class="top-focus-bar"></div>
        <input type="range" id="ageSlider" min="0" max="18" step="0.5" value="0">
    </div>

    <div id="chartArea" style="position: relative;">
        <div class="indicator-container">
            <div id="indicator" class="indicator-line"></div>
        </div>
    </div>

    <div class="info-panel" id="infoPanel">
        <div class="info-header"><span>å½“å‰å¹´é¾„å»ºè®® (ä»…ä¾›å‚è€ƒ)</span></div>
        <div class="info-content" id="infoContent"></div>
    </div>

    <!-- æ–°å¢ï¼šåº•éƒ¨é“¾æ¥åŒºåŸŸ -->
    <div class="footer-links">
        <a href="about.html" class="footer-link-item">â„¹ï¸ å…³äº Growy</a>
        <a href="https://x.com/GrowyAI" target="_blank" class="footer-link-item">ğ• Twitter</a>
        <a href="https://growyai.substack.com" target="_blank" class="footer-link-item">ğŸ“ Substack</a>
        <a href="https://mp.weixin.qq.com/s/ftYUVkcBBGB3yZLWohW-uw" target="_blank" class="footer-link-item">ğŸ’¬ å¾®ä¿¡å…¬ä¼—å·: é™ªä¼´ä¸æ–°ç”Ÿ</a>
        <a href="https://github.com/GrowyAI" target="_blank" class="footer-link-item">ğŸ’» GitHub</a>
        <a href="https://forms.google.com" target="_blank" class="footer-link-item">ğŸ“‹ åé¦ˆï¼ˆcoming soonï¼‰</a>
    </div>

    <div class="disclaimer">
        <p>å…è´£å£°æ˜ï¼šæœ¬å·¥å…·ä»…ä¾›æ•™è‚²å‚è€ƒï¼Œä¸æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­ã€‚</p>
        <p>Â© 2025 GrowyAI Â· ä¿ç•™æ‰€æœ‰æƒåˆ©</p>
    </div>
</div>

<!-- Detail Card Modal -->
<div class="detail-card-overlay" id="detailCardOverlay">
    <div class="detail-card">
        <div class="card-header">
            <div class="card-title" id="cardTitle"></div>
            <button class="card-close" onclick="hideDetailCard()">Ã—</button>
        </div>
        <div class="card-content" id="cardContent"></div>
    </div>
</div>

<script>
    // Language Switcher
    function switchLanguage(lang) {
        if (lang === 'zh') {
            window.location.href = './index.html';
        } else if (lang === 'en') {
            window.location.href = '../en/index.html';
        }
    }

    // Data
    const layers = [
        {
            id: "L1", title: "Layer 1: åŸºçŸ³ç³»ç»Ÿ", icon: "ğŸŒ±",
            skills: [
                { name: "å®‰å…¨ä¾æ‹", start: 0, end: 1.5, urgency: 3, desc: "**ã€Bowlby å…³é”®æœŸã€‘** å©´å„¿é€šè¿‡ä¸»è¦å…»è‚²è€…**åŠæ—¶ä¸”ä¸€è‡´**çš„å›åº”ï¼Œæ„å»ºâ€œå†…éƒ¨å·¥ä½œæ¨¡å‹â€çš„åŸºçŸ³ã€‚*åŸ¹å…»å»ºè®®ï¼šå»ºç«‹å›ºå®šçš„å®‰æŠšæ¨¡å¼ï¼ˆSecure Baseï¼‰ï¼Œå¹¶å›åº”å“­æ³£è€Œéæƒ©ç½šï¼Œä»¥å»ºç«‹åŸºæœ¬ä¿¡ä»»ã€‚*" },
                { name: "ä¾æ‹å·©å›º", start: 1.5, end: 3, urgency: 2, desc: "**ã€Erikson ä¿¡ä»» vs. è‡ªä¸»ã€‘** åœ¨å®‰å…¨ä¾æ‹åŸºç¡€ä¸Šï¼Œå­©å­å¼€å§‹æ¢ç´¢ä¸–ç•Œå¹¶å¯»æ±‚ç‹¬ç«‹ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±å­©å­åœ¨â€œå®‰å…¨åŸºåœ°â€é™„è¿‘è‡ªä¸»æ¢ç´¢ï¼Œæä¾›é€‰æ‹©æƒï¼Œæ”¯æŒå¹¶æ¥çº³åˆ†ç¦»æƒ…ç»ªã€‚*" },
                { name: "è‡ªæˆ‘æ„è¯†", start: 1.5, end: 3, urgency: 2, desc: "**ã€é•œå­å®éªŒã€‘** å­©å­å¼€å§‹åŒºåˆ†è‡ªæˆ‘ä¸ä»–äººï¼Œå‡ºç°â€œæˆ‘â€çš„æ¦‚å¿µã€‚*åŸ¹å…»å»ºè®®ï¼šåœ¨æ—¥å¸¸å¯¹è¯ä¸­å¤šä½¿ç”¨â€œä½ åšåˆ°äº†â€æˆ–â€œä½ æ„Ÿè§‰å¦‚ä½•â€ï¼Œå¸®åŠ©å­©å­å»ºç«‹ç§¯æçš„è‡ªæˆ‘æè¿°ã€‚*" },
                { name: "èº«ä»½è®¤åŒ", start: 12, end: 18, urgency: 2, desc: "**ã€Erikson èº«ä»½ vs. è¿·å¤±ã€‘** é’å°‘å¹´é€šè¿‡æ¢ç´¢ä»·å€¼è§‚å’Œè§’è‰²æ¥å›ç­”â€œæˆ‘æ˜¯è°â€ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±å­©å­å‚ä¸å„ç§æ´»åŠ¨ï¼Œè¿›è¡Œå¼€æ”¾å¼è®¨è®ºï¼Œæ¥çº³ä»–ä»¬åˆç†çš„è´¨ç–‘ä¸æ¢ç´¢ã€‚*" }
            ]
        },
        {
            id: "L2", title: "Layer 2: æ“ä½œç³»ç»Ÿ", icon: "ğŸ§ ",
            skills: [
                { name: "å†…åœ¨åŠ¨æœº", start: 0, end: 7, urgency: 3, desc: "**ã€Deci è‡ªå†³ç†è®ºã€‘** ä¿æŠ¤å­©å­ä¸ç”Ÿä¿±æ¥çš„å¥½å¥‡å¿ƒã€‚*åŸ¹å…»å»ºè®®ï¼šå°‘ç”¨é‡‘é’±æˆ–ç‰©è´¨å¥–åŠ±ï¼Œå¤šèµç¾â€œè¿‡ç¨‹â€è€Œéâ€œç»“æœâ€ï¼Œå¼ºè°ƒè‡ªä¸»æ€§ã€‚*" },
                { name: "æŠ‘åˆ¶æ§åˆ¶", start: 3, end: 6, urgency: 3, desc: "**ã€æ‰§è¡ŒåŠŸèƒ½æ ¸å¿ƒã€‘** ä¸“æ³¨åŠ›ä¸è‡ªå¾‹çš„åŸºç¡€ã€‚*åŸ¹å…»å»ºè®®ï¼šç©â€œçº¢ç¯åœã€ç»¿ç¯è¡Œâ€ç­‰è§„åˆ™æ¸¸æˆï¼›ä½¿ç”¨å»¶æ—¶æ»¡è¶³ç­–ç•¥ã€‚*" },
                { name: "æƒ…ç»ªè°ƒèŠ‚", start: 3, end: 7, urgency: 2, desc: "**ã€ç¥ç»å¯å¡‘æ€§ã€‘** å»ºç«‹åº”å¯¹è´Ÿé¢æƒ…ç»ªçš„ç¥ç»å›è·¯ã€‚*åŸ¹å…»å»ºè®®ï¼šæƒ…ç»ªå´©æºƒæ—¶å…ˆæ¥çº³ï¼Œå†å¼•å¯¼ç”¨è¯­è¨€è¡¨è¾¾ï¼Œè€Œä¸æ˜¯ç«‹å³åˆ¶æ­¢ã€‚*" },
                { name: "è§‚ç‚¹é‡‡æ‹©", start: 4, end: 7, urgency: 2, desc: "**ã€å¿ƒæ™ºç†è®ºã€‘** ç†è§£ä»–äººçš„æ„å›¾ã€‚*åŸ¹å…»å»ºè®®ï¼šé€šè¿‡è®²æ•…äº‹ã€æé—®ï¼ˆâ€œä»–ä¸ºä»€ä¹ˆå“­ï¼Ÿâ€ï¼‰å¼•å¯¼å­©å­æ¢ä½æ€è€ƒã€‚*" }
            ]
        },
        {
            id: "L3", title: "Layer 3: æ ¸å¿ƒèƒ½åŠ›", icon: "âš¡",
            skills: [
                { name: "è¯­è¨€(è¯­éŸ³)", start: 0, end: 7, urgency: 3, desc: "**ã€å¤§è„‘ä¿®å‰ªæœŸã€‘** å¬è§‰å¯¹éŸ³ç´ æ•æ„Ÿåº¦ä¸‹é™ã€‚*åŸ¹å…»å»ºè®®ï¼šæä¾›ä¸°å¯Œè¾“å…¥ï¼Œå£éŸ³è¶Šçº¯æ­£è¶Šå¥½ï¼›äº²å­å¯¹è¯æ¯”å¬éŸ³é¢‘æ›´é‡è¦ã€‚*" },
                { name: "å…·ä½“é€»è¾‘", start: 7, end: 11, urgency: 2, desc: "**ã€Piaget å…·ä½“è¿ç®—ã€‘** ç†è§£å®ˆæ’ã€åˆ†ç±»ã€‚*åŸ¹å…»å»ºè®®ï¼šé€šè¿‡åŠ¨æ‰‹æ“ä½œå®éªŒã€æ”¶é›†ä¸åˆ†ç±»ï¼Œç†è§£äº‹ç‰©å±æ€§ã€‚*" },
                { name: "æŠ½è±¡é€»è¾‘", start: 12, end: 18, urgency: 1, desc: "**ã€Piaget å½¢å¼è¿ç®—ã€‘** å‡è®¾-æ¼”ç»æ¨ç†ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±è¾©è®ºã€æ€è€ƒéç°å®å’Œå½¢è€Œä¸Šçš„é—®é¢˜ã€‚*" },
                { name: "è´¢å•†åŸºç¡€", start: 7, end: 18, urgency: 1, desc: "**ã€ç»æµå¿ƒç†å­¦ã€‘** ç†è§£å»¶è¿Ÿæ»¡è¶³å’Œæœºä¼šæˆæœ¬ã€‚*åŸ¹å…»å»ºè®®ï¼šåˆ©ç”¨é›¶èŠ±é’±å’Œé€æ˜ç½å­è¿›è¡Œâ€œæƒ³è¦â€å’Œâ€œéœ€è¦â€çš„åˆ†ç±»å®è·µã€‚*" }
            ]
        },
        {
            id: "L4", title: "Layer 4: æ˜¾æ€§æˆå°±", icon: "ğŸ†",
            skills: [
                { name: "ç»˜ç”»(è¡¨è¾¾)", start: 3, end: 7, urgency: 2, desc: "**ã€å›¾å¼æœŸã€‘** ä¿æŠ¤è¡¨è¾¾æ¬²ã€‚*åŸ¹å…»å»ºè®®ï¼šä¸è¯„ä»·â€œåƒä¸åƒâ€ï¼Œåªæé—®ï¼šâ€œä½ ç”»çš„æ˜¯ä»€ä¹ˆï¼Ÿâ€*" },
                { name: "ç»˜ç”»(æŠ€èƒ½)", start: 9, end: 12, urgency: 2, desc: "**ã€å†™å®æ•æ„ŸæœŸã€‘** å¼•å…¥è§‚å¯Ÿæ³•ä¸æŠ€å·§ã€‚*åŸ¹å…»å»ºè®®ï¼šæ•™å¯¼åŸºç¡€å‡ ä½•ç»“æ„å’Œæ¯”ä¾‹ï¼Œå¸®åŠ©å¼¥åˆè§†è§‰ä¸è¡¨è¾¾çš„å·®è·ã€‚*" },
                { name: "ç»å¯¹éŸ³æ„Ÿ", start: 3, end: 6, urgency: 3, desc: "**ã€æçŸ­çª—å£ã€‘** å¬è§‰ç¥ç»è¿æ¥å›ºå®šå‰ã€‚*åŸ¹å…»å»ºè®®ï¼šè¿›è¡Œç³»ç»Ÿæ€§éŸ³é«˜å¬è¾¨è®­ç»ƒï¼Œé”™è¿‡éš¾åº¦æŒ‡æ•°çº§ä¸Šå‡ã€‚*" },
                { name: "ä¹å™¨æŠ€å·§", start: 6, end: 10, urgency: 2, desc: "**ã€ç²¾ç»†åŠ¨ä½œé«˜å³°ã€‘** å»ºç«‹è‚Œè‚‰è®°å¿†ã€‚*åŸ¹å…»å»ºè®®ï¼šé€‰æ‹©é€‚åˆæ‰‹éƒ¨å‘è‚²çš„ä¹å™¨ï¼Œè§„å¾‹çŸ­æ—¶ç»ƒä¹ ã€‚*" },
                { name: "è¿åŠ¨(æŸ”éŸ§)", start: 5, end: 10, urgency: 2, desc: "**ã€éŸ§å¸¦å¯å¡‘æ€§ã€‘** éª¨éª¼ç”Ÿé•¿å‰ã€‚*åŸ¹å…»å»ºè®®ï¼šé¼“åŠ±ä½“æ“ã€èˆè¹ˆæˆ–æ­¦æœ¯ç­‰å¤§èŒƒå›´è¿åŠ¨ã€‚*" },
                { name: "è¿åŠ¨(åŠ›é‡)", start: 14, end: 18, urgency: 2, desc: "**ã€ç”Ÿç†é€‚åº”é«˜å³°ã€‘** éª¨éª¼æˆç†Ÿä¸æ¿€ç´ æ°´å¹³ä¸Šå‡ã€‚*åŸ¹å…»å»ºè®®ï¼šä»åŸºç¡€ä½“èƒ½è½¬å‘é«˜è´Ÿè·åŠ›é‡è®­ç»ƒï¼Œéœ€ä¸“ä¸šæŒ‡å¯¼ã€‚*" }
            ]
        }
    ];

    // DOM Elements
    const chartArea = document.getElementById('chartArea');
    const indicator = document.getElementById('indicator');
    const slider = document.getElementById('ageSlider');
    const ageVal = document.getElementById('ageVal');
    const infoContent = document.getElementById('infoContent');
    const topFocusBar = document.getElementById('topFocusBar');
    const detailCardOverlay = document.getElementById('detailCardOverlay');
    const cardTitle = document.getElementById('cardTitle');
    const cardContent = document.getElementById('cardContent');
    const colors = { 3: 'var(--green-critical)', 2: 'var(--green-sensitive)', 1: 'var(--green-open)' };

    function renderChart() {
        chartArea.querySelectorAll('.layer-section').forEach(e => e.remove());
        layers.forEach(layer => {
            const section = document.createElement('div');
            section.className = 'layer-section';
            section.innerHTML = `<div class="layer-header"><span class="layer-icon">${layer.icon}</span><span class="layer-title">${layer.title}</span></div>`;
            layer.skills.forEach(skill => {
                const row = document.createElement('div');
                row.className = 'chart-row';
                const label = document.createElement('div');
                label.className = 'skill-name';
                label.innerText = skill.name;
                label.addEventListener('click', () => showDetailCard(skill));
                const track = document.createElement('div');
                track.className = 'bar-track';
                const startPct = (skill.start / 18) * 100;
                const endPct = (Math.min(skill.end, 18) / 18) * 100;
                const widthPct = Math.max(endPct - startPct, 0);
                if (widthPct > 0) {
                    const bar = document.createElement('div');
                    bar.className = 'active-bar';
                    bar.style.left = `${startPct}%`;
                    bar.style.width = `${widthPct}%`;
                    bar.style.backgroundColor = colors[skill.urgency];
                    track.appendChild(bar);
                }
                row.appendChild(label);
                row.appendChild(track);
                section.appendChild(row);
            });
            chartArea.appendChild(section);
        });
    }

    function getUrgencyText(urgency) { return urgency === 3 ? "å…³é”®æœŸ" : urgency === 2 ? "æ•æ„ŸæœŸ" : "å‘å±•æœŸ"; }

    function showDetailCard(skill) {
        cardTitle.innerText = skill.name;
        const parts = skill.desc.split('*åŸ¹å…»å»ºè®®ï¼š');
        const theoryText = parts[0].trim().replace(/\*\*(.*?)\*\*/g, '$1');
        let adviceText = parts.length > 1 ? parts[1].trim().replace(/\*/g, '') : '';
        cardContent.innerHTML = `<div class="theory-section">ç†è®ºåŸºç¡€: ${theoryText}</div><div class="advice-section"><strong>åŸ¹å…»å»ºè®®:</strong> ${adviceText}</div>`;
        detailCardOverlay.classList.add('visible');
    }
    function hideDetailCard() { detailCardOverlay.classList.remove('visible'); }
    detailCardOverlay.addEventListener('click', (e) => { if (e.target === detailCardOverlay) hideDetailCard(); });

    function updateUI() {
        const age = parseFloat(slider.value);
        ageVal.innerText = age;
        
        // BUG FIX: Simple percentage positioning relative to the container
        const pct = (age / 18) * 100;
        indicator.style.left = `${pct}%`; // Removed the pixel offset calculation logic

        let activeItems = [];
        layers.forEach(layer => {
            layer.skills.forEach(skill => {
                let isActive = (age >= skill.start && age < skill.end);
                if (skill.end === 18 && age === 18) isActive = true;
                if (isActive) activeItems.push(skill);
            });
        });
        activeItems.sort((a, b) => b.urgency - a.urgency);

        const topBadges = activeItems.slice(0, 3);
        topFocusBar.innerHTML = topBadges.length === 0 
            ? `<span style="color:#aaa; font-size:0.75rem;">å½“å‰æ— ç‰¹å®šå…³é”®çª—å£ (å¹³ç¨³æœŸ)</span>` 
            : topBadges.map(item => `<div class="mini-badge" style="background:${colors[item.urgency]}">${item.name} <span style="opacity:0.8; font-size:0.65rem;">(${getUrgencyText(item.urgency)})</span></div>`).join('');

        if (activeItems.length === 0) {
            infoContent.innerHTML = `<div style="text-align:center;color:#999;padding:10px;">å»ºè®®å·©å›ºåŸºç¡€ï¼Œä¿æŒè€å¿ƒã€‚</div>`;
        } else {
            infoContent.innerHTML = activeItems.map(item => {
                let cleanDesc = item.desc.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                const adviceMatch = cleanDesc.match(/\*åŸ¹å…»å»ºè®®ï¼š(.*?)\*/);
                let adviceHtml = adviceMatch ? `<br><span style="color:#444;">å»ºè®®: ${adviceMatch[1].trim()}</span>` : '';
                cleanDesc = cleanDesc.replace(/\*åŸ¹å…»å»ºè®®ï¼š.*?\*/, '');
                return `<div class="advice-card"><div class="advice-title-row"><span class="advice-name">${item.name}</span><span class="urgency-badge" style="background-color:${colors[item.urgency]}">${getUrgencyText(item.urgency)}</span></div><div class="advice-desc">${cleanDesc.trim()} ${adviceHtml}</div></div>`;
            }).join('');
        }
    }

    renderChart();
    updateUI();
    slider.addEventListener('input', updateUI);
    window.addEventListener('resize', updateUI);
</script>
</body>
</html>